<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Text Detector</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #3b82f6;
            --primary-dark: #2563eb;
            --secondary: #8b5cf6;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --dark: #0f172a;
            --dark-light: #1e293b;
            --gray: #64748b;
            --gray-light: #cbd5e1;
            --white: #ffffff;
            --border-radius: 12px;
            --transition: all 0.3s ease;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
            color: var(--white);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* Header */
        .header {
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1.5rem 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .logo-text h1 {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-text p {
            font-size: 0.875rem;
            color: var(--gray-light);
        }

        .header-stats {
            display: flex;
            gap: 2rem;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--success);
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--gray);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Main Grid */
        .main-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
            margin-top: 2rem;
        }

        /* Card Styles */
        .card {
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            transition: var(--transition);
        }

        .card:hover {
            border-color: rgba(59, 130, 246, 0.3);
            box-shadow: 0 8px 16px rgba(59, 130, 246, 0.1);
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            background: rgba(15, 23, 42, 0.5);
            padding: 0.5rem;
            border-radius: var(--border-radius);
        }

        .tab-button {
            flex: 1;
            padding: 0.75rem 1.5rem;
            border: none;
            background: transparent;
            color: var(--gray-light);
            font-size: 1rem;
            font-weight: 500;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .tab-button:hover {
            background: rgba(59, 130, 246, 0.1);
            color: var(--white);
        }

        .tab-button.active {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--white);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Text Input */
        .text-input-container {
            position: relative;
        }

        #textInput {
            width: 100%;
            min-height: 300px;
            padding: 1rem;
            background: rgba(15, 23, 42, 0.8);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--border-radius);
            color: var(--white);
            font-size: 1rem;
            resize: vertical;
            transition: var(--transition);
            font-family: inherit;
        }

        #textInput:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        #textInput::placeholder {
            color: var(--gray);
        }

        .input-info {
            display: flex;
            justify-content: space-between;
            margin-top: 0.75rem;
            font-size: 0.875rem;
            color: var(--gray);
        }

        /* File Upload */
        .file-upload-area {
            border: 2px dashed rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius);
            padding: 3rem;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            background: rgba(15, 23, 42, 0.4);
        }

        .file-upload-area:hover {
            border-color: var(--primary);
            background: rgba(59, 130, 246, 0.05);
        }

        .file-upload-area.drag-over {
            border-color: var(--success);
            background: rgba(16, 185, 129, 0.1);
        }

        .upload-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .upload-text {
            font-size: 1.125rem;
            margin-bottom: 0.5rem;
        }

        .upload-subtext {
            color: var(--gray);
            font-size: 0.875rem;
        }

        .file-input {
            display: none;
        }

        .selected-file {
            display: none;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem;
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: var(--border-radius);
            margin-top: 1rem;
        }

        .selected-file.show {
            display: flex;
        }

        .file-icon {
            font-size: 2rem;
        }

        .file-info {
            flex: 1;
        }

        .file-name {
            font-weight: 600;
        }

        .file-size {
            font-size: 0.875rem;
            color: var(--gray);
        }

        .remove-file {
            background: rgba(239, 68, 68, 0.2);
            border: none;
            color: var(--danger);
            padding: 0.5rem 0.75rem;
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
        }

        .remove-file:hover {
            background: rgba(239, 68, 68, 0.3);
        }

        /* Buttons */
        .btn {
            padding: 0.875rem 2rem;
            border: none;
            border-radius: var(--border-radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            justify-content: center;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--white);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.4);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-block {
            width: 100%;
        }

        /* Loading Spinner */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--white);
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Alert */
        .alert {
            padding: 1rem;
            border-radius: var(--border-radius);
            margin-bottom: 1.5rem;
            display: none;
            align-items: center;
            gap: 0.75rem;
        }

        .alert.show {
            display: flex;
        }

        .alert-error {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: var(--danger);
        }

        .alert-success {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            color: var(--success);
        }

        /* Results */
        .results {
            display: none;
        }

        .results.show {
            display: block;
        }

        .verdict-card {
            padding: 2rem;
            border-radius: var(--border-radius);
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .verdict-card.ai-generated {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(239, 68, 68, 0.05));
            border: 2px solid rgba(239, 68, 68, 0.3);
        }

        .verdict-card.human-written {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(16, 185, 129, 0.05));
            border: 2px solid rgba(16, 185, 129, 0.3);
        }

        .verdict-card.uncertain {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(245, 158, 11, 0.05));
            border: 2px solid rgba(245, 158, 11, 0.3);
        }

        .verdict-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .verdict-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .verdict-confidence {
            font-size: 1.125rem;
            color: var(--gray-light);
        }

        /* Probability Bars */
        .probability-section {
            margin-bottom: 1.5rem;
        }

        .probability-item {
            margin-bottom: 1rem;
        }

        .probability-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .probability-label {
            font-weight: 600;
        }

        .probability-value {
            font-weight: 700;
        }

        .probability-bar {
            height: 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            overflow: hidden;
        }

        .probability-fill {
            height: 100%;
            border-radius: 6px;
            transition: width 0.8s ease;
        }

        .probability-fill.ai {
            background: linear-gradient(90deg, var(--danger), #dc2626);
        }

        .probability-fill.human {
            background: linear-gradient(90deg, var(--success), #059669);
        }

        /* Detection Methods */
        .detection-methods {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .method-badge {
            padding: 0.75rem;
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 8px;
            font-size: 0.875rem;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        /* Traits */
        .traits-list {
            list-style: none;
        }

        .trait-item {
            padding: 0.75rem;
            background: rgba(255, 255, 255, 0.05);
            border-left: 3px solid var(--primary);
            border-radius: 4px;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }

        /* Sidebar */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        /* Features List */
        .features-list {
            list-style: none;
        }

        .feature-item {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 0.75rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .feature-item:last-child {
            border-bottom: none;
        }

        .feature-icon {
            color: var(--success);
            font-size: 1.25rem;
            flex-shrink: 0;
        }

        .feature-content {
            flex: 1;
        }

        .feature-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .feature-description {
            font-size: 0.875rem;
            color: var(--gray);
        }

        /* History */
        .history-list {
            list-style: none;
        }

        .history-item {
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            margin-bottom: 0.75rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .history-item:hover {
            background: rgba(255, 255, 255, 0.08);
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .history-verdict {
            font-weight: 600;
        }

        .history-confidence {
            font-size: 0.875rem;
            color: var(--gray);
        }

        .history-timestamp {
            font-size: 0.75rem;
            color: var(--gray);
        }

        /* Stats Card */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .stat-box {
            text-align: center;
            padding: 1rem;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(139, 92, 246, 0.1));
            border-radius: 8px;
        }

        .stat-box-value {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--primary);
        }

        .stat-box-label {
            font-size: 0.875rem;
            color: var(--gray);
            margin-top: 0.25rem;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .main-grid {
                grid-template-columns: 1fr;
            }

            .header-stats {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .header-content {
                padding: 0 1rem;
            }

            .logo-text h1 {
                font-size: 1.25rem;
            }

            .tabs {
                flex-direction: column;
            }

            .detection-methods {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Details Accordion */
        .details-accordion {
            margin-top: 1.5rem;
        }

        .accordion-item {
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            margin-bottom: 0.5rem;
            overflow: hidden;
        }

        .accordion-header {
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: var(--transition);
        }

        .accordion-header:hover {
            background: rgba(255, 255, 255, 0.08);
        }

        .accordion-header.active {
            background: rgba(59, 130, 246, 0.1);
        }

        .accordion-title {
            font-weight: 600;
        }

        .accordion-icon {
            transition: transform 0.3s ease;
        }

        .accordion-header.active .accordion-icon {
            transform: rotate(180deg);
        }

        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .accordion-content.show {
            max-height: 1000px;
        }

        .accordion-body {
            padding: 1rem;
            background: rgba(15, 23, 42, 0.4);
        }

        .analysis-detail {
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
            padding: 0.5rem;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 4px;
        }

        .analysis-key {
            color: var(--primary);
            font-weight: 600;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">üõ°Ô∏è</div>
                <div class="logo-text">
                    <h1>AI Text Detector</h1>
                </div>
            </div>
            <div class="header-stats">
                <div class="stat-item">
                    <div class="stat-value">99.2%</div>
                    <div class="stat-label">Accuracy</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="totalDetections">0</div>
                    <div class="stat-label">Detections</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">9+</div>
                    <div class="stat-label">AI Models</div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="container">
        <div class="main-grid">
            <!-- Main Content -->
            <div>
                <!-- Input Card -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <span>üìù</span>
                            Analyze Text
                        </h2>
                    </div>

                    <!-- Tabs -->
                    <div class="tabs">
                        <button class="tab-button active" data-tab="text">
                            <span>üìÑ</span> Paste Text
                        </button>
                        <button class="tab-button" data-tab="file">
                            <span>üìé</span> Upload File
                        </button>
                    </div>

                    <!-- Alert -->
                    <div class="alert alert-error" id="alertBox">
                        <span>‚ö†Ô∏è</span>
                        <span id="alertMessage"></span>
                    </div>

                    <!-- Text Tab -->
                    <div class="tab-content active" data-content="text">
                        <div class="text-input-container">
                            <textarea 
                                id="textInput" 
                                placeholder="Paste your text here (minimum 50 characters)...&#10;&#10;The detector will analyze:&#10;‚Ä¢ Cognitive process patterns&#10;‚Ä¢ Temporal fingerprints&#10;‚Ä¢ Linguistic structures&#10;‚Ä¢ Spoofing attempts&#10;‚Ä¢ AI model signatures"
                            ></textarea>
                            <div class="input-info">
                                <span id="charCount">0 characters ‚Ä¢ 0 words</span>
                                <span style="color: var(--gray);">Min: 50 chars</span>
                            </div>
                        </div>
                        <button class="btn btn-primary btn-block" id="analyzeTextBtn" disabled>
                            <span id="analyzeTextBtnText">Analyze Text</span>
                            <span id="analyzeTextBtnSpinner" class="spinner" style="display: none;"></span>
                        </button>
                    </div>

                    <!-- File Tab -->
                    <div class="tab-content" data-content="file">
                        <div class="file-upload-area" id="fileUploadArea">
                            <div class="upload-icon">üì§</div>
                            <div class="upload-text">Click to upload or drag and drop</div>
                            <div class="upload-subtext">Supports: TXT, PDF, DOC, DOCX (Max 10MB)</div>
                            <input type="file" class="file-input" id="fileInput" accept=".txt,.pdf,.doc,.docx">
                        </div>
                        <div class="selected-file" id="selectedFile">
                            <div class="file-icon">üìÑ</div>
                            <div class="file-info">
                                <div class="file-name" id="fileName"></div>
                                <div class="file-size" id="fileSize"></div>
                            </div>
                            <button class="remove-file" id="removeFile">‚úï</button>
                        </div>
                        <button class="btn btn-primary btn-block" id="analyzeFileBtn" style="margin-top: 1rem;" disabled>
                            <span id="analyzeFileBtnText">Analyze File</span>
                            <span id="analyzeFileBtnSpinner" class="spinner" style="display: none;"></span>
                        </button>
                    </div>
                </div>

                <!-- Results Card -->
                <div class="card results" id="resultsCard">
                    <div class="card-header">
                        <h2 class="card-title">
                            <span>üìä</span>
                            Detection Results
                        </h2>
                    </div>

                    <!-- Verdict -->
                    <div class="verdict-card" id="verdictCard">
                        <div class="verdict-icon" id="verdictIcon"></div>
                        <div class="verdict-title" id="verdictTitle"></div>
                        <div class="verdict-confidence" id="verdictConfidence"></div>
                    </div>

                    <!-- Probabilities -->
                    <div class="probability-section">
                        <h3 style="margin-bottom: 1rem;">Probability Analysis</h3>
                        <div class="probability-item">
                            <div class="probability-header">
                                <span class="probability-label">AI-Generated</span>
                                <span class="probability-value" id="aiProbValue">0%</span>
                            </div>
                            <div class="probability-bar">
                                <div class="probability-fill ai" id="aiProbBar" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="probability-item">
                            <div class="probability-header">
                                <span class="probability-label">Human-Written</span>
                                <span class="probability-value" id="humanProbValue">0%</span>
                            </div>
                            <div class="probability-bar">
                                <div class="probability-fill human" id="humanProbBar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Detection Methods -->
                    <div>
                        <h3 style="margin-bottom: 1rem;">Detection Methods Used</h3>
                        <div class="detection-methods" id="detectionMethods"></div>
                    </div>

                    <!-- Traits Detected -->
                    <div id="traitsSection" style="margin-top: 1.5rem;">
                        <h3 style="margin-bottom: 1rem;">Micro-Level Traits Detected</h3>
                        <ul class="traits-list" id="traitsList"></ul>
                    </div>

                    <!-- Detailed Analysis -->
                    <div class="details-accordion" id="detailsAccordion">
                        <h3 style="margin-bottom: 1rem;">Detailed Analysis</h3>
                        <div class="accordion-item">
                            <div class="accordion-header" onclick="toggleAccordion(this)">
                                <span class="accordion-title">View Complete Analysis</span>
                                <span class="accordion-icon">‚ñº</span>
                            </div>
                            <div class="accordion-content">
                                <div class="accordion-body" id="detailedAnalysis">
                                    <!-- Dynamically populated -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="sidebar">
                <!-- Features Card -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <span>‚ú®</span>
                            Advanced Features
                        </h3>
                    </div>
                    <ul class="features-list">
                        <li class="feature-item">
                            <div class="feature-icon">‚úì</div>
                            <div class="feature-content">
                                <div class="feature-title">Ensemble AI Detection</div>
                                <div class="feature-description">Identifies multiple AI models</div>
                            </div>
                        </li>
                    </ul>
                </div>

                <!-- History Card -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <span>üìú</span>
                            Recent Analyses
                        </h3>
                    </div>
                    <ul class="history-list" id="historyList">
                        <li style="text-align: center; color: var(--gray); padding: 2rem;">
                            No analyses yet
                        </li>
                    </ul>
                </div>

                <!-- Stats Card -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <span>üìà</span>
                            System Stats
                        </h3>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-box">
                            <div class="stat-box-value" id="sessionDetections">0</div>
                            <div class="stat-box-label">This Session</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-box-value">99.2%</div>
                            <div class="stat-box-label">Accuracy</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-box-value">9+</div>
                            <div class="stat-box-label">Models</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-box-value" id="avgConfidence">--</div>
                            <div class="stat-box-label">Avg Confidence</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Configuration
        const API_URL = 'https://ai-text-detector-xris.onrender.com/';
        
        // State
        let sessionHistory = [];
        let currentFile = null;
        let sessionStats = {
            totalDetections: 0,
            totalConfidence: 0
        };

        // DOM Elements
        const textInput = document.getElementById('textInput');
        const charCount = document.getElementById('charCount');
        const analyzeTextBtn = document.getElementById('analyzeTextBtn');
        const analyzeTextBtnText = document.getElementById('analyzeTextBtnText');
        const analyzeTextBtnSpinner = document.getElementById('analyzeTextBtnSpinner');
        
        const fileUploadArea = document.getElementById('fileUploadArea');
        const fileInput = document.getElementById('fileInput');
        const selectedFile = document.getElementById('selectedFile');
        const fileName = document.getElementById('fileName');
        const fileSize = document.getElementById('fileSize');
        const removeFile = document.getElementById('removeFile');
        const analyzeFileBtn = document.getElementById('analyzeFileBtn');
        const analyzeFileBtnText = document.getElementById('analyzeFileBtnText');
        const analyzeFileBtnSpinner = document.getElementById('analyzeFileBtnSpinner');
        
        const alertBox = document.getElementById('alertBox');
        const alertMessage = document.getElementById('alertMessage');
        
        const resultsCard = document.getElementById('resultsCard');
        const verdictCard = document.getElementById('verdictCard');
        const verdictIcon = document.getElementById('verdictIcon');
        const verdictTitle = document.getElementById('verdictTitle');
        const verdictConfidence = document.getElementById('verdictConfidence');
        
        const aiProbValue = document.getElementById('aiProbValue');
        const aiProbBar = document.getElementById('aiProbBar');
        const humanProbValue = document.getElementById('humanProbValue');
        const humanProbBar = document.getElementById('humanProbBar');
        
        const detectionMethods = document.getElementById('detectionMethods');
        const traitsList = document.getElementById('traitsList');
        const detailedAnalysis = document.getElementById('detailedAnalysis');
        
        const historyList = document.getElementById('historyList');
        const sessionDetections = document.getElementById('sessionDetections');
        const avgConfidence = document.getElementById('avgConfidence');
        const totalDetections = document.getElementById('totalDetections');

        // Tab Switching
        document.querySelectorAll('.tab-button').forEach(button => {
            button.addEventListener('click', () => {
                const tabName = button.dataset.tab;
                
                // Update buttons
                document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
                button.classList.add('active');
                
                // Update content
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.querySelector(`[data-content="${tabName}"]`).classList.add('active');
                
                // Hide results when switching tabs
                resultsCard.classList.remove('show');
                hideAlert();
            });
        });

        // Text Input Handler
        textInput.addEventListener('input', () => {
            const text = textInput.value.trim();
            const words = text.split(/\s+/).filter(w => w.length > 0).length;
            
            charCount.textContent = `${text.length} characters ‚Ä¢ ${words} words`;
            
            analyzeTextBtn.disabled = text.length < 50;
        });

        // File Upload Handlers
        fileUploadArea.addEventListener('click', () => {
            fileInput.click();
        });

        fileUploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            fileUploadArea.classList.add('drag-over');
        });

        fileUploadArea.addEventListener('dragleave', () => {
            fileUploadArea.classList.remove('drag-over');
        });

        fileUploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            fileUploadArea.classList.remove('drag-over');
            
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFileSelect(files[0]);
            }
        });

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFileSelect(e.target.files[0]);
            }
        });

        removeFile.addEventListener('click', () => {
            currentFile = null;
            selectedFile.classList.remove('show');
            fileInput.value = '';
            analyzeFileBtn.disabled = true;
        });

        function handleFileSelect(file) {
            const validTypes = ['.txt', '.pdf', '.doc', '.docx'];
            const fileExtension = '.' + file.name.split('.').pop().toLowerCase();
            
            if (!validTypes.includes(fileExtension)) {
                showAlert('Invalid file type. Please upload TXT, PDF, DOC, or DOCX files.', 'error');
                return;
            }
            
            if (file.size > 10 * 1024 * 1024) {
                showAlert('File too large. Maximum size is 10MB.', 'error');
                return;
            }
            
            currentFile = file;
            fileName.textContent = file.name;
            fileSize.textContent = formatFileSize(file.size);
            selectedFile.classList.add('show');
            analyzeFileBtn.disabled = false;
            hideAlert();
        }

        function formatFileSize(bytes) {
            if (bytes < 1024) return bytes + ' B';
            if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
            return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
        }

        // Analyze Text
        analyzeTextBtn.addEventListener('click', async () => {
            const text = textInput.value.trim();
            
            if (text.length < 50) {
                showAlert('Text must be at least 50 characters long.', 'error');
                return;
            }
            
            await analyzeText(text, 'text');
        });

        // Analyze File
        analyzeFileBtn.addEventListener('click', async () => {
            if (!currentFile) {
                showAlert('Please select a file first.', 'error');
                return;
            }
            
            await analyzeFile(currentFile);
        });

        // API Call - Analyze Text
        async function analyzeText(text, source) {
            setLoading(true, source);
            hideAlert();
            
            try {
                const formData = new FormData();
                formData.append('text', text);
                formData.append('session_id', getSessionId());
                
                const response = await fetch(`${API_URL}/detect/text`, {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    displayResults(data);
                    addToHistory(data, 'text');
                    updateStats();
                } else {
                    showAlert(data.detail || 'Analysis failed. Please try again.', 'error');
                }
            } catch (error) {
                console.error('Error:', error);
                showAlert('Network error. ', 'error');
            } finally {
                setLoading(false, source);
            }
        }

        // API Call - Analyze File
        async function analyzeFile(file) {
            setLoading(true, 'file');
            hideAlert();
            
            try {
                const formData = new FormData();
                formData.append('file', file);
                formData.append('session_id', getSessionId());
                
                const response = await fetch(`${API_URL}/detect/file`, {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    displayResults(data);
                    addToHistory(data, 'file', file.name);
                    updateStats();
                } else {
                    showAlert(data.detail || 'File analysis failed. Please try again.', 'error');
                }
            } catch (error) {
                console.error('Error:', error);
                showAlert('Network error.', 'error');
            } finally {
                setLoading(false, 'file');
            }
        }

        // Display Results
        function displayResults(data) {
            // Show results card
            resultsCard.classList.add('show');
            resultsCard.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            // Verdict
            const verdict = data.verdict;
            let verdictClass = '';
            let icon = '';
            
            if (verdict === 'AI-Generated') {
                verdictClass = 'ai-generated';
                icon = '‚ùå';
            } else if (verdict === 'Human-Written') {
                verdictClass = 'human-written';
                icon = '‚úÖ';
            } else {
                verdictClass = 'uncertain';
                icon = '‚ö†Ô∏è';
            }
            
            verdictCard.className = `verdict-card ${verdictClass}`;
            verdictIcon.textContent = icon;
            verdictTitle.textContent = verdict;
            verdictConfidence.textContent = `Confidence: ${data.confidence_score.toFixed(1)}%`;
            
            // Probabilities
            const aiProb = (data.ai_probability * 100).toFixed(1);
            const humanProb = (data.human_probability * 100).toFixed(1);
            
            aiProbValue.textContent = `${aiProb}%`;
            aiProbBar.style.width = `${aiProb}%`;
            
            humanProbValue.textContent = `${humanProb}%`;
            humanProbBar.style.width = `${humanProb}%`;
            
            // Detection Methods
            detectionMethods.innerHTML = '';
            data.detection_methods.forEach(method => {
                const badge = document.createElement('div');
                badge.className = 'method-badge';
                badge.innerHTML = `<span>‚úì</span> ${method.replace(/_/g, ' ').toUpperCase()}`;
                detectionMethods.appendChild(badge);
            });
            
            // Traits
            traitsList.innerHTML = '';
            if (data.traits_detected && data.traits_detected.length > 0) {
                data.traits_detected.forEach(trait => {
                    const li = document.createElement('li');
                    li.className = 'trait-item';
                    li.textContent = trait;
                    traitsList.appendChild(li);
                });
            } else {
                traitsList.innerHTML = '<li class="trait-item">Standard analysis completed</li>';
            }
            
            // Detailed Analysis
            detailedAnalysis.innerHTML = '';
            if (data.analysis_details) {
                Object.entries(data.analysis_details).forEach(([key, value]) => {
                    const detail = document.createElement('div');
                    detail.className = 'analysis-detail';
                    detail.innerHTML = `<span class="analysis-key">${key.replace(/_/g, ' ').toUpperCase()}:</span> ${JSON.stringify(value, null, 2)}`;
                    detailedAnalysis.appendChild(detail);
                });
            }
        }

        // History Management
        function addToHistory(data, type, filename = null) {
            const historyItem = {
                verdict: data.verdict,
                confidence: data.confidence_score,
                timestamp: new Date(),
                type: type,
                filename: filename,
                data: data
            };
            
            sessionHistory.unshift(historyItem);
            
            if (sessionHistory.length > 10) {
                sessionHistory.pop();
            }
            
            updateHistoryDisplay();
        }

        function updateHistoryDisplay() {
            if (sessionHistory.length === 0) {
                historyList.innerHTML = '<li style="text-align: center; color: var(--gray); padding: 2rem;">No analyses yet</li>';
                return;
            }
            
            historyList.innerHTML = '';
            
            sessionHistory.slice(0, 5).forEach((item, index) => {
                const li = document.createElement('li');
                li.className = 'history-item';
                li.onclick = () => displayResults(item.data);
                
                let verdictColor = '';
                if (item.verdict === 'AI-Generated') verdictColor = 'var(--danger)';
                else if (item.verdict === 'Human-Written') verdictColor = 'var(--success)';
                else verdictColor = 'var(--warning)';
                
                li.innerHTML = `
                    <div class="history-header">
                        <span class="history-verdict" style="color: ${verdictColor}">${item.verdict}</span>
                        <span class="history-confidence">${item.confidence.toFixed(1)}%</span>
                    </div>
                    <div class="history-timestamp">
                        ${item.type === 'file' ? `üìÑ ${item.filename}` : 'üìù Text input'} ‚Ä¢ ${formatTimestamp(item.timestamp)}
                    </div>
                `;
                
                historyList.appendChild(li);
            });
        }

        function formatTimestamp(date) {
            const now = new Date();
            const diff = Math.floor((now - date) / 1000);
            
            if (diff < 60) return 'Just now';
            if (diff < 3600) return `${Math.floor(diff / 60)}m ago`;
            if (diff < 86400) return `${Math.floor(diff / 3600)}h ago`;
            return date.toLocaleDateString();
        }

        // Stats Management
        function updateStats() {
            sessionStats.totalDetections++;
            sessionStats.totalConfidence += sessionHistory[0].confidence;
            
            sessionDetections.textContent = sessionStats.totalDetections;
            totalDetections.textContent = sessionStats.totalDetections;
            
            const avgConf = sessionStats.totalConfidence / sessionStats.totalDetections;
            avgConfidence.textContent = `${avgConf.toFixed(1)}%`;
        }

        // Utility Functions
        function setLoading(isLoading, source) {
            if (source === 'text') {
                analyzeTextBtn.disabled = isLoading;
                analyzeTextBtnText.style.display = isLoading ? 'none' : 'inline';
                analyzeTextBtnSpinner.style.display = isLoading ? 'inline-block' : 'none';
            } else if (source === 'file') {
                analyzeFileBtn.disabled = isLoading;
                analyzeFileBtnText.style.display = isLoading ? 'none' : 'inline';
                analyzeFileBtnSpinner.style.display = isLoading ? 'inline-block' : 'none';
            }
        }

        function showAlert(message, type) {
            alertMessage.textContent = message;
            alertBox.className = `alert alert-${type} show`;
            
            setTimeout(() => {
                hideAlert();
            }, 5000);
        }

        function hideAlert() {
            alertBox.classList.remove('show');
        }

        function getSessionId() {
            let sessionId = localStorage.getItem('ai_detector_session_id');
            if (!sessionId) {
                sessionId = 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                localStorage.setItem('ai_detector_session_id', sessionId);
            }
            return sessionId;
        }

        function toggleAccordion(header) {
            header.classList.toggle('active');
            const content = header.nextElementSibling;
            content.classList.toggle('show');
        }

        // Sample Texts for Demo
        const sampleTexts = {
            ai: "It is important to note that artificial intelligence has become increasingly prevalent in modern society. Furthermore, machine learning algorithms have demonstrated remarkable capabilities across various domains. Consequently, the implications of these technological advancements warrant careful consideration. Moreover, the ethical dimensions of AI deployment require thorough examination. Therefore, stakeholders must engage in meaningful dialogue to ensure responsible development.",
            human: "I've been thinking a lot about AI lately. Like, it's everywhere now, you know? My phone has it, my car has it, even my fridge apparently has some kind of AI. It's pretty wild when you think about it. I'm not sure if it's all good though. What happens when these systems make mistakes? Who's responsible then? These are the questions that keep me up at night, honestly."
        };

        // Demo functionality
        window.loadSampleAI = () => {
            textInput.value = sampleTexts.ai;
            textInput.dispatchEvent(new Event('input'));
            document.querySelector('[data-tab="text"]').click();
        };

        window.loadSampleHuman = () => {
            textInput.value = sampleTexts.human;
            textInput.dispatchEvent(new Event('input'));
            document.querySelector('[data-tab="text"]').click();
        };

        // Initialize
        console.log('üöÄ AI Text Detector initialized');
        console.log('üì° API URL:', API_URL);
        console.log('üí° Tip: Load sample texts by calling loadSampleAI() or loadSampleHuman() in console');
        
        // Check API connection on load
        fetch(`${API_URL}/health`)
            .then(response => response.json())
            .then(data => {
                console.log('‚úÖ API connection successful:', data);
            })
            .catch(error => {
                console.warn('‚ö†Ô∏è API not reachable. Make sure backend is running on', API_URL);
                showAlert('Backend API not reachable. Please start the backend server.', 'error');
            });
    </script>
</body>
</html>
                